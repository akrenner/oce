<!-- Generated by pkgdown: do not edit by hand -->
<!DOCTYPE html>
<html lang="en">
  <head>
  <meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">

<title>Lunar Angle as Function of Space and Time — moonAngle • oce</title>


<!-- jquery -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script>
<!-- Bootstrap -->

<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/css/bootstrap.min.css" integrity="sha256-bZLfwXAP04zRMK2BjiO8iu9pf4FbLqX6zitd+tIvLhE=" crossorigin="anonymous" />

<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script>

<!-- bootstrap-toc -->
<link rel="stylesheet" href="../bootstrap-toc.css">
<script src="../bootstrap-toc.js"></script>

<!-- Font Awesome icons -->
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous" />
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous" />

<!-- clipboard.js -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script>

<!-- headroom.js -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script>

<!-- pkgdown -->
<link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script>




<meta property="og:title" content="Lunar Angle as Function of Space and Time — moonAngle" />
<meta property="og:description" content="The calculations are based on formulae provided by Meeus (1982), primarily
in chapters 6, 18, and 30.  The first step is to compute sidereal time as
formulated in Meeus (1982) chapter 7, which in turn uses Julian day computed
according to as formulae in Meeus (1982) chapter 3.  Using these quantities,
formulae in Meeus (1982) chapter 30 are then used to compute geocentric
longitude (\(lambda\), in the Meeus notation), geocentric latitude
(\(beta\)), and parallax.  Then the obliquity of the ecliptic
is computed with Meeus (1982) equation 18.4.  Equatorial coordinates (right
ascension and declination) are computed with equations 8.3 and 8.4 from
Meeus (1982), using eclipticalToEquatorial().  The hour angle
(\(H\)) is computed using the unnumbered equation preceding Meeus's
(1982) equation 8.1.  Finally, Meeus (1982) equations 8.5 and 8.6 are used
to calculate the local azimuth and altitude of the moon, using
equatorialToLocalHorizontal()." />




<!-- mathjax -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script>

<!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->



  </head>

  <body data-spy="scroll" data-target="#toc">
    <div class="container template-reference-topic">
      <header>
      <div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">oce</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="Released version">1.4-0</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
        <li>
  <a href="../index.html">
    <span class="fas fa-home fa-lg"></span>
     
  </a>
</li>
<li>
  <a href="../articles/oce.html">Get started</a>
</li>
<li>
  <a href="../reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    Articles
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
    <li>
      <a href="../articles/adp.html">3. Analysis of acoustic-Doppler data</a>
    </li>
    <li>
      <a href="../articles/ctd.html">2. Analysis of CTD data</a>
    </li>
    <li>
      <a href="../articles/flags.html">5. Dealing with data-quality flags</a>
    </li>
    <li>
      <a href="../articles/map_projections.html">4. Using map projections</a>
    </li>
    <li>
      <a href="../articles/subclassing.html">6. Subclassing oce objects</a>
    </li>
  </ul>
</li>
<li>
  <a href="../news/index.html">Changelog</a>
</li>
      </ul>
      <ul class="nav navbar-nav navbar-right">
        <li>
  <a href="https://github.com/dankelley/oce/">
    <span class="fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
      
    </div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

      

      </header>

<div class="row">
  <div class="col-md-9 contents">
    <div class="page-header">
    <h1>Lunar Angle as Function of Space and Time</h1>
    <small class="dont-index">Source: <a href='https://github.com/dankelley/oce/blob/master/R/moon.R'><code>R/moon.R</code></a></small>
    <div class="hidden name"><code>moonAngle.Rd</code></div>
    </div>

    <div class="ref-description">
    <p>The calculations are based on formulae provided by Meeus (1982), primarily
in chapters 6, 18, and 30.  The first step is to compute sidereal time as
formulated in Meeus (1982) chapter 7, which in turn uses Julian day computed
according to as formulae in Meeus (1982) chapter 3.  Using these quantities,
formulae in Meeus (1982) chapter 30 are then used to compute geocentric
longitude (\(lambda\), in the Meeus notation), geocentric latitude
(\(beta\)), and parallax.  Then the <code>obliquity</code> of the ecliptic
is computed with Meeus (1982) equation 18.4.  Equatorial coordinates (right
ascension and declination) are computed with equations 8.3 and 8.4 from
Meeus (1982), using <code><a href='eclipticalToEquatorial.html'>eclipticalToEquatorial()</a></code>.  The hour angle
(\(H\)) is computed using the unnumbered equation preceding Meeus's
(1982) equation 8.1.  Finally, Meeus (1982) equations 8.5 and 8.6 are used
to calculate the local azimuth and altitude of the moon, using
<code><a href='equatorialToLocalHorizontal.html'>equatorialToLocalHorizontal()</a></code>.</p>
    </div>

    <pre class="usage"><span class='fu'>moonAngle</span><span class='op'>(</span><span class='va'>t</span>, longitude <span class='op'>=</span> <span class='fl'>0</span>, latitude <span class='op'>=</span> <span class='fl'>0</span>, useRefraction <span class='op'>=</span> <span class='cn'>TRUE</span><span class='op'>)</span></pre>

    <h2 class="hasAnchor" id="arguments"><a class="anchor" href="#arguments"></a>Arguments</h2>
    <table class="ref-arguments">
    <colgroup><col class="name" /><col class="desc" /></colgroup>
    <tr>
      <th>t</th>
      <td><p>time, a POSIXt object (converted to timezone <code>"UTC"</code>,
if it is not already in that timezone), a character or numeric value that
corresponds to such a time.</p></td>
    </tr>
    <tr>
      <th>longitude</th>
      <td><p>observer longitude in degrees east</p></td>
    </tr>
    <tr>
      <th>latitude</th>
      <td><p>observer latitude in degrees north</p></td>
    </tr>
    <tr>
      <th>useRefraction</th>
      <td><p>boolean, set to <code>TRUE</code> to apply a correction for
atmospheric refraction.  (Ignored at present.)</p></td>
    </tr>
    </table>

    <h2 class="hasAnchor" id="value"><a class="anchor" href="#value"></a>Value</h2>

    <p>A list containing the following.</p><ul>
<li><p><code>time</code></p></li>
<li><p><code>azimuth</code> moon azimuth, in degrees eastward of north, from 0 to 360.
Note: this is not the convention used by Meeus, who uses degrees westward of
South. Here, the convention is chosen to more closely match the expectation
of oceanographers.</p></li>
<li><p><code>altitude</code> moon altitude, in degrees from -90 to 90.</p></li>
<li><p><code>rightAscension</code> in' degrees.</p></li>
<li><p><code>declination</code> in degrees.</p></li>
<li><p><code>lambda</code> geocentric longitude, in degrees.</p></li>
<li><p><code>beta</code> geocentric latitude, in degrees.</p></li>
<li><p><code>diameter</code> lunar diameter, in degrees.</p></li>
<li><p><code>distance</code> earth-moon distance, in kilometers.</p></li>
<li><p><code>illuminatedFraction</code> fraction of moon's visible disk that is illuminated.</p></li>
<li><p><code>phase</code> phase of the moon, defined in equation 32.3 of Meeus (1982).
The fractional part of which is 0 for new moon, 1/4 for first
quarter, 1/2 for full moon, and 3/4 for last quarter.</p></li>
</ul>

<p><img src='figures/starCoords.png' alt='options:width=400px' /></p>
    <h2 class="hasAnchor" id="alternate-formulations"><a class="anchor" href="#alternate-formulations"></a>Alternate formulations</h2>

    

<p>Formulae provide by Meeus (1982) are used
for all calculations here.  Meeus (1991) provides formulae that are similar,
but that differ in the 5th or 6th digits.  For example, the formula for
ephemeris time in Meeus (1991) differs from that in Meeus (1992) at the 5th
digit, and almost all of the approximately 200 coefficients in the relevant
formulae also differ in the 5th and 6th digits.  Discussion of the changing
formulations is best left to members of the astronomical community.  For the
present purpose, it may be sufficient to note that <code>moonAngle</code>, based
on Meeus (1982), reproduces the values provided in example 45.a of Meeus
(1991) to 4 significant digits, e.g. with all angles matching to under 2
minutes of arc.</p>
    <h2 class="hasAnchor" id="references"><a class="anchor" href="#references"></a>References</h2>

    
<ul>
<li><p>Meeus, Jean. Astronomical Formulas for Calculators. Second Edition.
Richmond, Virginia, USA: Willmann-Bell, 1982.</p></li>
<li><p>Meeus, Jean. Astronomical Algorithms. Second Edition.
Richmond, Virginia, USA: Willmann-Bell, 1991.</p></li>
</ul>

    <h2 class="hasAnchor" id="see-also"><a class="anchor" href="#see-also"></a>See also</h2>

    <div class='dont-index'><p>The equivalent function for the sun is <code><a href='sunAngle.html'>sunAngle()</a></code>.</p>
<p>Other things related to astronomy: 
<code><a href='angle2hms.html'>angle2hms</a>()</code>,
<code><a href='eclipticalToEquatorial.html'>eclipticalToEquatorial</a>()</code>,
<code><a href='equatorialToLocalHorizontal.html'>equatorialToLocalHorizontal</a>()</code>,
<code><a href='julianCenturyAnomaly.html'>julianCenturyAnomaly</a>()</code>,
<code><a href='julianDay.html'>julianDay</a>()</code>,
<code><a href='siderealTime.html'>siderealTime</a>()</code>,
<code><a href='sunAngle.html'>sunAngle</a>()</code>,
<code><a href='sunDeclinationRightAscension.html'>sunDeclinationRightAscension</a>()</code></p></div>
    <h2 class="hasAnchor" id="author"><a class="anchor" href="#author"></a>Author</h2>

    <p>Dan Kelley, based on formulae in Meeus (1982).</p>

    <h2 class="hasAnchor" id="examples"><a class="anchor" href="#examples"></a>Examples</h2>
    <pre class="examples"><div class='input'>
<span class='kw'><a href='https://rdrr.io/r/base/library.html'>library</a></span><span class='op'>(</span><span class='va'><a href='https://dankelley.github.io/oce/'>oce</a></span><span class='op'>)</span>
<span class='fu'><a href='https://rdrr.io/r/graphics/par.html'>par</a></span><span class='op'>(</span>mfrow<span class='op'>=</span><span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='fl'>3</span>,<span class='fl'>2</span><span class='op'>)</span><span class='op'>)</span>
<span class='va'>y</span> <span class='op'>&lt;-</span> <span class='fl'>2012</span>
<span class='va'>m</span> <span class='op'>&lt;-</span> <span class='fl'>4</span>
<span class='va'>days</span> <span class='op'>&lt;-</span> <span class='fl'>1</span><span class='op'>:</span><span class='fl'>3</span>
<span class='co'>## Halifax sunrise/sunset (see e.g. https://www.timeanddate.com/worldclock)</span>
<span class='va'>rises</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/ISOdatetime.html'>ISOdatetime</a></span><span class='op'>(</span><span class='va'>y</span>, <span class='va'>m</span>, <span class='va'>days</span>,<span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='fl'>13</span>,<span class='fl'>15</span>,<span class='fl'>16</span><span class='op'>)</span>, <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='fl'>55</span>, <span class='fl'>04</span>, <span class='fl'>16</span><span class='op'>)</span>,<span class='fl'>0</span>,tz<span class='op'>=</span><span class='st'>"UTC"</span><span class='op'>)</span> <span class='op'>+</span> <span class='fl'>3</span> <span class='op'>*</span> <span class='fl'>3600</span> <span class='co'># ADT</span>
<span class='va'>sets</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/ISOdatetime.html'>ISOdatetime</a></span><span class='op'>(</span><span class='va'>y</span>, <span class='va'>m</span>,<span class='va'>days</span>,<span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='fl'>3</span>,<span class='fl'>4</span>,<span class='fl'>4</span><span class='op'>)</span>, <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='fl'>42</span>, <span class='fl'>15</span>, <span class='fl'>45</span><span class='op'>)</span>,<span class='fl'>0</span>,tz<span class='op'>=</span><span class='st'>"UTC"</span><span class='op'>)</span> <span class='op'>+</span> <span class='fl'>3</span> <span class='op'>*</span> <span class='fl'>3600</span>
<span class='va'>azrises</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='fl'>69</span>, <span class='fl'>75</span>, <span class='fl'>82</span><span class='op'>)</span>
<span class='va'>azsets</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='fl'>293</span>, <span class='fl'>288</span>, <span class='fl'>281</span><span class='op'>)</span>
<span class='va'>latitude</span> <span class='op'>&lt;-</span> <span class='fl'>44.65</span>
<span class='va'>longitude</span> <span class='op'>&lt;-</span> <span class='op'>-</span><span class='fl'>63.6</span>
<span class='kw'>for</span> <span class='op'>(</span><span class='va'>i</span> <span class='kw'>in</span> <span class='fl'>1</span><span class='op'>:</span><span class='fl'>3</span><span class='op'>)</span> <span class='op'>{</span>
    <span class='va'>t</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/ISOdatetime.html'>ISOdatetime</a></span><span class='op'>(</span><span class='va'>y</span>, <span class='va'>m</span>, <span class='va'>days</span><span class='op'>[</span><span class='va'>i</span><span class='op'>]</span>,<span class='fl'>0</span>,<span class='fl'>0</span>,<span class='fl'>0</span>,tz<span class='op'>=</span><span class='st'>"UTC"</span><span class='op'>)</span> <span class='op'>+</span> <span class='fu'><a href='https://rdrr.io/r/base/seq.html'>seq</a></span><span class='op'>(</span><span class='fl'>0</span>, <span class='fl'>24</span><span class='op'>*</span><span class='fl'>3600</span>, <span class='fl'>3600</span><span class='op'>/</span><span class='fl'>4</span><span class='op'>)</span>
    <span class='va'>ma</span> <span class='op'>&lt;-</span> <span class='fu'>moonAngle</span><span class='op'>(</span><span class='va'>t</span>, <span class='va'>longitude</span>, <span class='va'>latitude</span><span class='op'>)</span>
    <span class='fu'><a href='oce.plot.ts.html'>oce.plot.ts</a></span><span class='op'>(</span><span class='va'>t</span>, <span class='va'>ma</span><span class='op'>$</span><span class='va'>altitude</span>, type<span class='op'>=</span><span class='st'>'l'</span>, mar<span class='op'>=</span><span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='fl'>2</span>, <span class='fl'>3</span>, <span class='fl'>1</span>, <span class='fl'>1</span><span class='op'>)</span>, cex<span class='op'>=</span><span class='fl'>1</span><span class='op'>/</span><span class='fl'>2</span>, ylab<span class='op'>=</span><span class='st'>"Altitude"</span><span class='op'>)</span>
    <span class='fu'><a href='https://rdrr.io/r/graphics/abline.html'>abline</a></span><span class='op'>(</span>h<span class='op'>=</span><span class='fl'>0</span><span class='op'>)</span>
    <span class='fu'><a href='https://rdrr.io/r/graphics/points.html'>points</a></span><span class='op'>(</span><span class='va'>rises</span><span class='op'>[</span><span class='va'>i</span><span class='op'>]</span>, <span class='fl'>0</span>, col<span class='op'>=</span><span class='st'>'red'</span>, pch<span class='op'>=</span><span class='fl'>3</span>, lwd<span class='op'>=</span><span class='fl'>2</span>, cex<span class='op'>=</span><span class='fl'>1.5</span><span class='op'>)</span>
    <span class='fu'><a href='https://rdrr.io/r/graphics/points.html'>points</a></span><span class='op'>(</span><span class='va'>sets</span><span class='op'>[</span><span class='va'>i</span><span class='op'>]</span>, <span class='fl'>0</span>, col<span class='op'>=</span><span class='st'>'blue'</span>, pch<span class='op'>=</span><span class='fl'>3</span>, lwd<span class='op'>=</span><span class='fl'>2</span>, cex<span class='op'>=</span><span class='fl'>1.5</span><span class='op'>)</span>
    <span class='fu'><a href='oce.plot.ts.html'>oce.plot.ts</a></span><span class='op'>(</span><span class='va'>t</span>, <span class='va'>ma</span><span class='op'>$</span><span class='va'>azimuth</span>, type<span class='op'>=</span><span class='st'>'l'</span>, mar<span class='op'>=</span><span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='fl'>2</span>, <span class='fl'>3</span>, <span class='fl'>1</span>, <span class='fl'>1</span><span class='op'>)</span>, cex<span class='op'>=</span><span class='fl'>1</span><span class='op'>/</span><span class='fl'>2</span>, ylab<span class='op'>=</span><span class='st'>"Azimuth"</span><span class='op'>)</span>
    <span class='fu'><a href='https://rdrr.io/r/graphics/points.html'>points</a></span><span class='op'>(</span><span class='va'>rises</span><span class='op'>[</span><span class='va'>i</span><span class='op'>]</span>, <span class='op'>-</span><span class='fl'>180</span><span class='op'>+</span><span class='va'>azrises</span><span class='op'>[</span><span class='va'>i</span><span class='op'>]</span>, col<span class='op'>=</span><span class='st'>'red'</span>, pch<span class='op'>=</span><span class='fl'>3</span>, lwd<span class='op'>=</span><span class='fl'>2</span>, cex<span class='op'>=</span><span class='fl'>1.5</span><span class='op'>)</span>
    <span class='fu'><a href='https://rdrr.io/r/graphics/points.html'>points</a></span><span class='op'>(</span><span class='va'>sets</span><span class='op'>[</span><span class='va'>i</span><span class='op'>]</span>, <span class='op'>-</span><span class='fl'>180</span><span class='op'>+</span><span class='va'>azsets</span><span class='op'>[</span><span class='va'>i</span><span class='op'>]</span>, col<span class='op'>=</span><span class='st'>'blue'</span>, pch<span class='op'>=</span><span class='fl'>3</span>, lwd<span class='op'>=</span><span class='fl'>2</span>, cex<span class='op'>=</span><span class='fl'>1.5</span><span class='op'>)</span>
<span class='op'>}</span>
</div><div class='img'><img src='moonAngle-1.png' alt='' width='700' height='433' /></div><div class='input'>
</div></pre>
  </div>
  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">
    <nav id="toc" data-toggle="toc" class="sticky-top">
      <h2 data-toc-skip>Contents</h2>
    </nav>
  </div>
</div>


      <footer>
      <div class="copyright">
  <p>Developed by Dan Kelley, Clark Richards.</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="https://pkgdown.r-lib.org/">pkgdown</a> 1.6.1.</p>
</div>

      </footer>
   </div>

  


  </body>
</html>


